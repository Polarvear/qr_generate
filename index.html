<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Online Barcode & QR Code Generator (Client‑side, SEO & AdSense Ready)</title>
  <meta name="description" content="Create barcodes (CODE128, EAN, UPC, CODE39, ITF, MSI, Pharmacode) and QR codes in your browser. No uploads. Download as PNG or SVG. Batch export supported." />
  <meta name="keywords" content="barcode generator, QR code generator, CODE128, EAN, UPC, CODE39, ITF, MSI, Pharmacode, client-side, offline, png, svg, batch"/>
  <link rel="canonical" href="https://example.com/barcode-qr-generator"/>
  <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1"/>
  <meta name="theme-color" content="#0ea5e9" />
  <meta property="og:title" content="Online Barcode & QR Code Generator" />
  <meta property="og:description" content="Fast, privacy-first barcode & QR generator. Download PNG/SVG, batch export, and more." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://example.com/barcode-qr-generator" />
  <meta property="og:image" content="https://example.com/og/barcode-qr.png" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- ✅ Google AdSense (paste your real publisher id to enable verification). For review, auto-ads script in <head> is sufficient. -->
  <!-- 주석(ko): 승인 전에는 아래 client 값을 실제 ca-pub-xxxxxxxx 로 교체만 하면 되고, 바디의 광고 슬롯(ins)은 없어도 무방합니다. -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX" crossorigin="anonymous"></script>

  <!-- Libraries (via jsDelivr). All generation is client-side. -->
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js" defer></script>

  <style>
    :root{--bg:#0b1220;--card:#0e1726;--ink:#e6f2ff;--muted:#9bb3cc;--brand:#0ea5e9;--ok:#16a34a;--warn:#f59e0b;--err:#ef4444}
    html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial,"Apple Color Emoji","Segoe UI Emoji";color:var(--ink);background:linear-gradient(180deg,#0b1220,#0a0f1a)}
    a{color:var(--brand);text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    header{display:flex;gap:16px;align-items:center;justify-content:space-between}
    .title{display:flex;align-items:center;gap:12px}
    .badge{font-size:12px;color:#0a1526;background:#c7ecff22;border:1px solid #3aa9ff33;padding:3px 8px;border-radius:999px}
    nav a{margin:0 8px;font-weight:600}
    .grid{display:grid;grid-template-columns:1.2fr 1fr;gap:18px}
    .card{background:linear-gradient(180deg,#0f1930,#0c1528);border:1px solid #1b2a44;border-radius:16px;box-shadow:0 10px 30px #0008;padding:18px}
    h1{font-size:28px;margin:10px 0}
    h2{font-size:18px;margin:0 0 12px 0;color:#cfe7ff}
    label{font-size:13px;color:var(--muted)}
    input,select,button,textarea{border-radius:10px;border:1px solid #163154;background:#0a1426;color:var(--ink);padding:10px}
    input:focus,select:focus,textarea:focus{outline:2px solid #1f84d6;border-color:#245c8f}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .row-3{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .actions{display:flex;gap:8px;flex-wrap:wrap}
    .btn{cursor:pointer;font-weight:700}
    .btn.primary{background:linear-gradient(180deg,#36c3ff,#1e88ff);color:#001a33;border:0}
    .btn.ghost{background:transparent;border:1px solid #22406b}
    .btn.success{background:linear-gradient(180deg,#34d399,#059669);border:0;color:#00170f}
    .preview{display:flex;align-items:center;justify-content:center;min-height:260px;background:#061126;border:1px dashed #1c3356;border-radius:12px}
    .kicker{font-size:13px;color:#9dbbdb}
    .muted{color:var(--muted)}
    .tabs{display:flex;gap:8px;margin-top:12px}
    .tab{padding:8px 12px;border-radius:999px;border:1px solid #1f355e;background:#0a1526;color:#cfe7ff;cursor:pointer}
    .tab[aria-selected="true"]{background:#10224b;border-color:#2a4b86}
    .alert{padding:10px 12px;border-radius:10px;background:#22120f;border:1px solid #5f1d14;color:#ffc3b5}
    .ok{color:#71f5b3}
    .ad-slot{display:block;min-height:280px;border-radius:12px;border:1px dashed #1f3355;background:#0a1526;display:flex;align-items:center;justify-content:center;color:#6c88ad}
    footer{margin-top:32px;padding-top:24px;border-top:1px solid #14264a;color:#a9c6e6}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    .sr-only{position:absolute;left:-9999px;width:1px;height:1px;overflow:hidden}
    .help{font-size:12px;color:#9ab6d8}
    .switch{display:flex;gap:8px;align-items:center}
    .pill{padding:4px 8px;border-radius:999px;background:#1b2c4b;color:#bfe2ff;font-size:12px}

    /* Responsive */
    @media (max-width: 900px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 4h1v16H4zm3 0h2v16H7zm4 0h1v16h-1zm3 0h3v16h-3zm5 0h1v16h-1z" fill="#86d7ff"/></svg>
        <div>
          <h1>Barcode & QR Code Generator</h1>
          <div class="kicker">Privacy‑first • Client‑side • PNG/SVG • Batch export</div>
        </div>
      </div>
      <nav aria-label="Secondary">
        <a href="#howto">How‑to</a>
        <a href="#faq">FAQ</a>
        <a href="#privacy">Privacy</a>
        <a href="#contact">Contact</a>
      </nav>
    </header>

    <!-- Ad placeholder (keeps layout stable; optional to keep during review) -->
    <div class="ad-slot" role="complementary" aria-label="Advertisement placeholder">
      <!-- ✅ When approved, insert a responsive ad unit here. Replace client & slot. -->
      <!--
      <ins class="adsbygoogle" style="display:block;min-height:280px" data-ad-client="ca-pub-XXXXXXXXXXXXXXXX" data-ad-slot="NNNNNNNNNN" data-ad-format="auto" data-full-width-responsive="true"></ins>
      <script>window.adsbygoogle && (adsbygoogle=window.adsbygoogle||[]).push({});</script>
      -->
      <span class="muted">Ad will appear here after approval</span>
    </div>

    <div class="tabs" role="tablist" aria-label="Generator type">
      <button id="tab-barcode" class="tab" role="tab" aria-controls="panel-barcode" aria-selected="true">Barcode</button>
      <button id="tab-qr" class="tab" role="tab" aria-controls="panel-qr" aria-selected="false">QR Code</button>
      <span class="pill">FNC1: type <span class="mono">\F</span> → GS</span>
    </div>

    <main class="grid" id="main">
      <!-- ========== BARCODE PANEL ========== -->
      <section id="panel-barcode" class="card" role="tabpanel" aria-labelledby="tab-barcode">
        <h2>Barcode</h2>
        <div class="row">
          <div>
            <label for="bc-text">Content</label>
            <input id="bc-text" class="mono" placeholder="e.g. 0108801234560016\F1713052510ABC123" autocomplete="off" />
            <div class="help">Use <span class="mono">\\F</span> for FNC1 (Group Separator) when needed.</div>
          </div>
          <div>
            <label for="bc-format">Format</label>
            <select id="bc-format">
              <option>CODE128</option>
              <option>CODE128A</option>
              <option>CODE128B</option>
              <option>CODE128C</option>
              <option>EAN13</option>
              <option>EAN8</option>
              <option>UPC</option>
              <option>CODE39</option>
              <option>ITF14</option>
              <option>ITF</option>
              <option>MSI</option>
              <option>MSI10</option>
              <option>MSI11</option>
              <option>MSI1010</option>
              <option>MSI1110</option>
              <option>Pharmacode</option>
            </select>
          </div>
        </div>

        <div class="row-3" style="margin-top:8px">
          <div>
            <label for="bc-width">Bar width</label>
            <input id="bc-width" type="number" min="1" value="2" />
          </div>
          <div>
            <label for="bc-height">Height</label>
            <input id="bc-height" type="number" min="10" value="120" />
          </div>
          <div>
            <label for="bc-margin">Margin</label>
            <input id="bc-margin" type="number" min="0" value="10" />
          </div>
        </div>

        <div class="row-3" style="margin-top:8px">
          <div>
            <label for="bc-bg">Background</label>
            <input id="bc-bg" type="color" value="#ffffff" />
          </div>
          <div>
            <label for="bc-line">Line color</label>
            <input id="bc-line" type="color" value="#000000" />
          </div>
          <div class="switch" style="margin-top:22px">
            <input id="bc-display" type="checkbox" checked />
            <label for="bc-display">Show human‑readable text</label>
          </div>
        </div>

        <div class="row-3" style="margin-top:8px">
          <div>
            <label for="bc-textpos">Text position</label>
            <select id="bc-textpos"><option>bottom</option><option>top</option></select>
          </div>
          <div>
            <label for="bc-textalign">Text align</label>
            <select id="bc-textalign"><option>center</option><option>left</option><option>right</option></select>
          </div>
          <div>
            <label for="bc-font">Font</label>
            <select id="bc-font"><option>monospace</option><option>sans-serif</option><option>serif</option><option>fantasy</option><option>cursive</option></select>
          </div>
        </div>

        <div class="row-3" style="margin-top:8px">
          <div>
            <label for="bc-fontsize">Font size</label>
            <input id="bc-fontsize" type="number" min="6" value="16" />
          </div>
          <div>
            <label for="bc-textmargin">Text margin</label>
            <input id="bc-textmargin" type="number" min="0" value="2" />
          </div>
          <div class="switch" style="margin-top:22px">
            <input id="bc-bold" type="checkbox" />
            <label for="bc-bold">Bold text</label>
            <input id="bc-italic" type="checkbox" style="margin-left:12px" />
            <label for="bc-italic">Italic text</label>
          </div>
        </div>

        <div class="actions" style="margin-top:12px">
          <button class="btn primary" id="btn-bc-generate">Generate</button>
          <button class="btn ghost" id="btn-bc-reset">Reset</button>
          <button class="btn" id="btn-bc-copy">Copy PNG</button>
          <button class="btn" id="btn-bc-dl-png">Download PNG</button>
          <button class="btn" id="btn-bc-dl-svg">Download SVG</button>
          <button class="btn" id="btn-bc-batch">Batch ZIP (newline separated)</button>
        </div>

        <div id="bc-error" class="alert" role="alert" aria-live="polite" style="display:none;margin-top:12px"></div>
        <div class="preview" id="bc-preview" aria-live="polite" aria-busy="false" style="margin-top:12px">
          <svg id="bc-svg" role="img" aria-label="Barcode preview"></svg>
        </div>
      </section>

      <!-- ========== QR PANEL ========== -->
      <section id="panel-qr" class="card" role="tabpanel" aria-labelledby="tab-qr" hidden>
        <h2>QR Code</h2>
        <div class="row">
          <div>
            <label for="qr-text">Content</label>
            <textarea id="qr-text" rows="3" placeholder="https://example.com or any text"></textarea>
          </div>
          <div>
            <label for="qr-size">Size (px)</label>
            <input id="qr-size" type="number" min="64" value="256" />
          </div>
        </div>
        <div class="row-3" style="margin-top:8px">
          <div>
            <label for="qr-ec">Error correction</label>
            <select id="qr-ec"><option value="L">L (7%)</option><option value="M" selected>M (15%)</option><option value="Q">Q (25%)</option><option value="H">H (30%)</option></select>
          </div>
          <div>
            <label for="qr-bg">Background</label>
            <input id="qr-bg" type="color" value="#ffffff" />
          </div>
          <div>
            <label for="qr-fg">Color</label>
            <input id="qr-fg" type="color" value="#000000" />
          </div>
        </div>
        <div class="actions" style="margin-top:12px">
          <button class="btn primary" id="btn-qr-generate">Generate</button>
          <button class="btn ghost" id="btn-qr-reset">Reset</button>
          <button class="btn" id="btn-qr-copy">Copy PNG</button>
          <button class="btn" id="btn-qr-dl-png">Download PNG</button>
          <button class="btn" id="btn-qr-batch">Batch ZIP (newline separated)</button>
        </div>
        <div id="qr-error" class="alert" role="alert" aria-live="polite" style="display:none;margin-top:12px"></div>
        <div class="preview" id="qr-preview" aria-live="polite" style="margin-top:12px">
          <canvas id="qr-canvas" width="256" height="256" role="img" aria-label="QR preview"></canvas>
        </div>
      </section>
    </main>

    <section id="howto" class="card" style="margin-top:18px">
      <h2>How‑to</h2>
      <ol>
        <li>Choose <strong>Barcode</strong> or <strong>QR Code</strong>.</li>
        <li>Enter content. For FNC1 separator in GS1 barcodes, type <span class="mono">\\F</span>.</li>
        <li>Adjust visual options.</li>
        <li>Click <em>Generate</em>, then <em>Download PNG/SVG</em> or <em>Copy</em>.</li>
        <li>For <strong>batch</strong>, input one value per line and use <em>Batch ZIP</em>.</li>
      </ol>
      <p class="help">All processing happens locally in your browser. No files or text are uploaded to any server.</p>
    </section>

    <section id="faq" class="card" style="margin-top:18px">
      <h2>FAQ</h2>
      <details open>
        <summary>Which barcode formats are supported?</summary>
        <p>CODE128 (A/B/C), EAN13, EAN8, UPC, CODE39, ITF, ITF14, MSI (incl. 10/11/1010/1110), Pharmacode, and QR Code.</p>
      </details>
      <details>
        <summary>Does this work offline?</summary>
        <p>Yes, after the libraries are cached by your browser, generation is fully client‑side.</p>
      </details>
      <details>
        <summary>Is my data stored?</summary>
        <p>No. Everything runs in your browser. Nothing is sent to a server.</p>
      </details>
      <details>
        <summary>Ads cause layout shifts. How do you avoid that?</summary>
        <p>Ad containers reserve space (min‑height) to protect Core Web Vitals and page experience.</p>
      </details>
    </section>

    <section id="privacy" class="card" style="margin-top:18px">
      <h2>Privacy Policy (Short)</h2>
      <p>We do not collect, store, or transmit the text or images you generate. Third‑party ads, when enabled, may use cookies—refer to their policies.</p>
    </section>

    <section id="contact" class="card" style="margin-top:18px">
      <h2>Contact</h2>
      <p>Email: contact@example.com</p>
    </section>

    <footer>
      <div>© <span id="y"></span> Barcode & QR Generator • <a href="#privacy">Privacy</a> • <a href="#faq">FAQ</a></div>
      <div class="help">Built for speed & accessibility. No tracking. No uploads.</div>
    </footer>
  </div>

  <!-- Structured data: HowTo & FAQ for SEO -->
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"HowTo","name":"How to generate a barcode or QR code online","step":[{"@type":"HowToStep","text":"Choose Barcode or QR Code."},{"@type":"HowToStep","text":"Enter your content. Use \\F for FNC1 (GS) in GS1 barcodes."},{"@type":"HowToStep","text":"Adjust options and click Generate."},{"@type":"HowToStep","text":"Download as PNG/SVG or copy to clipboard."}]}
  </script>
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"Which barcode formats are supported?","acceptedAnswer":{"@type":"Answer","text":"CODE128 (A/B/C), EAN13, EAN8, UPC, CODE39, ITF, ITF14, MSI (incl. 10/11/1010/1110), Pharmacode, and QR Code."}},{"@type":"Question","name":"Does this work offline?","acceptedAnswer":{"@type":"Answer","text":"Yes. Generation is fully client‑side once libraries are cached."}},{"@type":"Question","name":"Is my data stored?","acceptedAnswer":{"@type":"Answer","text":"No. Nothing is transmitted to a server."}}]}
  </script>

  <script>
    // ===== i18n-lite & UX helpers =====
    const $ = (sel) => document.querySelector(sel);
    const $$ = (sel) => Array.from(document.querySelectorAll(sel));
    const ls = (k, v) => v === undefined ? JSON.parse(localStorage.getItem(k) || 'null') : localStorage.setItem(k, JSON.stringify(v));
    const debounce = (fn, d=180) => { let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a), d); } };

    // ===== Tabs =====
    const tabBarcode = $('#tab-barcode');
    const tabQR = $('#tab-qr');
    const panelBarcode = $('#panel-barcode');
    const panelQR = $('#panel-qr');
    tabBarcode.addEventListener('click', ()=>{ tabBarcode.setAttribute('aria-selected','true'); tabQR.setAttribute('aria-selected','false'); panelBarcode.hidden=false; panelQR.hidden=true; });
    tabQR.addEventListener('click', ()=>{ tabQR.setAttribute('aria-selected','true'); tabBarcode.setAttribute('aria-selected','false'); panelQR.hidden=false; panelBarcode.hidden=true; });

    // ===== Footer year =====
    $('#y').textContent = new Date().getFullYear();

    // ===== Barcode generation =====
    const bc = {
      text: $('#bc-text'), format: $('#bc-format'), width: $('#bc-width'), height: $('#bc-height'), margin: $('#bc-margin'),
      bg: $('#bc-bg'), line: $('#bc-line'), display: $('#bc-display'), textpos: $('#bc-textpos'), textalign: $('#bc-textalign'),
      font: $('#bc-font'), fontsize: $('#bc-fontsize'), textmargin: $('#bc-textmargin'), bold: $('#bc-bold'), italic: $('#bc-italic'),
      svg: $('#bc-svg'), err: $('#bc-error')
    };

    function sanitizeFNC1(input){
      // 주석(ko): 사용자가 \F를 입력하면 ASCII 29(Group Separator)로 변환
      return input.replace(/\\F/g, String.fromCharCode(29));
    }

    function buildFontOptions(){
      const opts=[]; if(bc.bold.checked) opts.push('bold'); if(bc.italic.checked) opts.push('italic');
      return opts.join(' ');
    }

    function renderBarcode(){
      bc.err.style.display='none';
      const text = sanitizeFNC1(bc.text.value.trim());
      if(!text){ bc.svg.replaceChildren(); return; }
      try{
        JsBarcode(bc.svg, text, {
          format: (bc.format.value||'CODE128').replace('EAN13','EAN'),
          width: Math.max(1, +bc.width.value||2),
          height: Math.max(10, +bc.height.value||120),
          margin: Math.max(0, +bc.margin.value||0),
          background: bc.bg.value || '#ffffff',
          lineColor: bc.line.value || '#000000',
          displayValue: bc.display.checked,
          textPosition: bc.textpos.value,
          textAlign: bc.textalign.value,
          font: bc.font.value,
          fontOptions: buildFontOptions(),
          fontSize: Math.max(6, +bc.fontsize.value||16),
          textMargin: Math.max(0, +bc.textmargin.value||2)
        });
      }catch(err){
        bc.svg.replaceChildren();
        bc.err.textContent = err?.message || 'Invalid data';
        bc.err.style.display='block';
      }
    }

    // Auto-preview (debounced)
    ['input','change'].forEach(evt=>{
      panelBarcode.addEventListener(evt, debounce(renderBarcode, 120));
    });

    // Buttons
    $('#btn-bc-generate').addEventListener('click', renderBarcode);
    $('#btn-bc-reset').addEventListener('click', ()=>{
      bc.text.value=''; bc.width.value=2; bc.height.value=120; bc.margin.value=10; bc.bg.value='#ffffff'; bc.line.value='#000000';
      bc.display.checked=true; bc.textpos.value='bottom'; bc.textalign.value='center'; bc.font.value='monospace'; bc.fontsize.value=16; bc.textmargin.value=2; bc.bold.checked=false; bc.italic.checked=false;
      renderBarcode();
    });

    async function svgToPngBlob(svgEl){
      // Serialize SVG → PNG
      const svg = new Blob([new XMLSerializer().serializeToString(svgEl)], {type:'image/svg+xml'});
      const url = URL.createObjectURL(svg);
      const img = new Image(); img.decoding='async';
      await new Promise(res=>{ img.onload=res; img.src=url; });
      const canvas = document.createElement('canvas');
      const bb = svgEl.getBBox(); // better fit
      canvas.width = Math.max(2, Math.ceil(bb.width + 20));
      canvas.height = Math.max(2, Math.ceil(bb.height + 20));
      const ctx = canvas.getContext('2d');
      ctx.fillStyle = bc.bg.value || '#ffffff';
      ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.drawImage(img, 10, 10);
      URL.revokeObjectURL(url);
      return new Promise(res=> canvas.toBlob(res, 'image/png'));
    }

    async function copyBarcodePng(){
      if(!bc.svg.childNodes.length){ return; }
      const blob = await svgToPngBlob(bc.svg);
      try{
        await navigator.clipboard.write([ new ClipboardItem({ 'image/png': blob }) ]);
        notice('Copied barcode PNG to clipboard', 'ok');
      }catch(e){
        downloadBlob(blob, 'barcode.png');
      }
    }

    function downloadBlob(blob, filename){
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob); a.download = filename; a.click();
      setTimeout(()=>URL.revokeObjectURL(a.href),5000);
    }

    $('#btn-bc-copy').addEventListener('click', copyBarcodePng);
    $('#btn-bc-dl-png').addEventListener('click', async ()=>{
      if(!bc.svg.childNodes.length) return; const blob = await svgToPngBlob(bc.svg); downloadBlob(blob,'barcode.png');
    });
    $('#btn-bc-dl-svg').addEventListener('click', ()=>{
      if(!bc.svg.childNodes.length) return;
      const svg = new Blob([new XMLSerializer().serializeToString(bc.svg)], {type:'image/svg+xml'});
      downloadBlob(svg,'barcode.svg');
    });

    // Batch ZIP (newline separated)
    $('#btn-bc-batch').addEventListener('click', async ()=>{
      const lines = bc.text.value.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
      if(!lines.length){ notice('Enter one value per line for batch export', 'warn'); return; }
      const zip = new JSZip();
      for(const [i,raw] of lines.entries()){
        const content = sanitizeFNC1(raw);
        const tmp = document.createElementNS('http://www.w3.org/2000/svg','svg');
        try{
          JsBarcode(tmp, content, {format:(bc.format.value||'CODE128').replace('EAN13','EAN'), width:+bc.width.value||2, height:+bc.height.value||120, margin:+bc.margin.value||0, background:bc.bg.value, lineColor:bc.line.value, displayValue:false});
          const png = await (async()=>{ // svg→png
            const blob = new Blob([new XMLSerializer().serializeToString(tmp)], {type:'image/svg+xml'});
            const url = URL.createObjectURL(blob); const img = new Image(); await new Promise(r=>{img.onload=r; img.src=url});
            const c = document.createElement('canvas'); const bb = tmp.getBBox(); c.width=Math.ceil(bb.width+20); c.height=Math.ceil(bb.height+20);
            const ctx=c.getContext('2d'); ctx.fillStyle=bc.bg.value; ctx.fillRect(0,0,c.width,c.height); ctx.drawImage(img,10,10); URL.revokeObjectURL(url);
            return await new Promise(res=>c.toBlob(res,'image/png'));
          })();
          zip.file(`barcode_${i+1}.png`, png);
        }catch(e){ zip.file(`barcode_${i+1}_ERROR.txt`, `Failed: ${raw}\n${e?.message||e}`) }
      }
      const out = await zip.generateAsync({type:'blob'}); saveAs(out,'barcodes.zip');
    });

    // ===== QR generation =====
    const qr = {
      text: $('#qr-text'), size: $('#qr-size'), ec: $('#qr-ec'), bg: $('#qr-bg'), fg: $('#qr-fg'), canvas: $('#qr-canvas'), err: $('#qr-error')
    };

    function renderQR(){
      qr.err.style.display='none';
      const text = qr.text.value.trim(); if(!text){ const ctx=qr.canvas.getContext('2d'); ctx.clearRect(0,0,qr.canvas.width,qr.canvas.height); return; }
      try{
        const typeNumber = 0; // auto
        const ec = qr.ec.value; // 'L','M','Q','H'
        const q = qrcode(typeNumber, ec);
        q.addData(text); q.make();
        const size = Math.max(64, +qr.size.value||256);
        qr.canvas.width = qr.canvas.height = size;
        const ctx = qr.canvas.getContext('2d');
        const tileW = size / q.getModuleCount();
        const tileH = size / q.getModuleCount();
        // Background
        ctx.fillStyle = qr.bg.value || '#ffffff';
        ctx.fillRect(0,0,size,size);
        // Modules
        ctx.fillStyle = qr.fg.value || '#000000';
        for (let row = 0; row < q.getModuleCount(); row++){
          for (let col = 0; col < q.getModuleCount(); col++){
            if (q.isDark(row, col)){
              const w = Math.ceil((col+1)*tileW) - Math.floor(col*tileW);
              const h = Math.ceil((row+1)*tileH) - Math.floor(row*tileH);
              ctx.fillRect(Math.round(col*tileW), Math.round(row*tileH), w, h);
            }
          }
        }
      }catch(err){
        qr.err.textContent = err?.message || 'Invalid data';
        qr.err.style.display='block';
      }
    }

    ['input','change'].forEach(evt=> panelQR.addEventListener(evt, debounce(renderQR, 120)));
    $('#btn-qr-generate').addEventListener('click', renderQR);
    $('#btn-qr-reset').addEventListener('click', ()=>{ qr.text.value=''; qr.size.value=256; qr.bg.value='#ffffff'; qr.fg.value='#000000'; qr.ec.value='M'; renderQR(); });

    async function copyQR(){
      const blob = await new Promise(res=> qr.canvas.toBlob(res, 'image/png'));
      try{
        await navigator.clipboard.write([ new ClipboardItem({ 'image/png': blob }) ]);
        notice('Copied QR PNG to clipboard','ok');
      }catch(e){ downloadBlob(blob,'qr.png'); }
    }
    $('#btn-qr-copy').addEventListener('click', copyQR);
    $('#btn-qr-dl-png').addEventListener('click', async ()=>{
      const blob = await new Promise(res=> qr.canvas.toBlob(res, 'image/png')); downloadBlob(blob,'qr.png');
    });

    $('#btn-qr-batch').addEventListener('click', async ()=>{
      const lines = qr.text.value.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
      if(!lines.length){ notice('Enter one value per line for batch export', 'warn'); return; }
      const zip = new JSZip();
      for(const [i,content] of lines.entries()){
        try{
          const typeNumber=0; const q=qrcode(typeNumber, qr.ec.value); q.addData(content); q.make();
          const size = Math.max(64, +qr.size.value||256);
          const c = document.createElement('canvas'); c.width=c.height=size; const ctx=c.getContext('2d');
          const tileW=size/q.getModuleCount(), tileH=tileW; ctx.fillStyle=qr.bg.value; ctx.fillRect(0,0,size,size); ctx.fillStyle=qr.fg.value;
          for(let r=0;r<q.getModuleCount();r++){ for(let k=0;k<q.getModuleCount();k++){ if(q.isDark(r,k)){ const w=Math.ceil((k+1)*tileW)-Math.floor(k*tileW); const h=Math.ceil((r+1)*tileH)-Math.floor(r*tileH); ctx.fillRect(Math.round(k*tileW),Math.round(r*tileH),w,h); }}}
          const blob = await new Promise(res=> c.toBlob(res,'image/png'));
          zip.file(`qr_${i+1}.png`, blob);
        }catch(e){ zip.file(`qr_${i+1}_ERROR.txt`, `Failed: ${content}\n${e?.message||e}`) }
      }
      const out = await zip.generateAsync({type:'blob'}); saveAs(out,'qrs.zip');
    });

    // ===== Little toast =====
    let toastT;
    function notice(msg, kind){
      clearTimeout(toastT);
      const el = document.createElement('div');
      el.textContent = msg; el.role='status';
      el.style.position='fixed'; el.style.right='16px'; el.style.bottom='16px'; el.style.background = kind==='ok'? '#123a2a' : (kind==='warn'? '#3a2d12' : '#312022');
      el.style.border = '1px solid ' + (kind==='ok'? '#1e7b58' : kind==='warn'? '#6b5217' : '#6b2520');
      el.style.padding='10px 12px'; el.style.borderRadius='12px'; el.style.color='#eaf7ff'; el.style.zIndex=9999; el.style.boxShadow='0 6px 22px #0006';
      document.body.appendChild(el); toastT=setTimeout(()=>el.remove(), 2200);
    }

    // ===== Persist last inputs (optional) =====
    const persistKeys = ['bc-text','bc-format','bc-width','bc-height','bc-margin','bc-bg','bc-line','bc-display','bc-textpos','bc-textalign','bc-font','bc-fontsize','bc-textmargin','bc-bold','bc-italic','qr-text','qr-size','qr-ec','qr-bg','qr-fg'];
    window.addEventListener('beforeunload', ()=>{
      const obj={}; for(const id of persistKeys){ const el=document.getElementById(id); obj[id] = (el.type==='checkbox')? el.checked : el.value; } ls('persist',obj)
    });
    window.addEventListener('DOMContentLoaded', ()=>{
      const obj = ls('persist')||{}; for(const id of persistKeys){ const el=document.getElementById(id); if(obj[id]!==undefined){ if(el.type==='checkbox') el.checked=!!obj[id]; else el.value=obj[id]; } }
      renderBarcode(); renderQR();
    });
  </script>

  <!-- 주석(ko): 이 파일은 정적 단일 HTML로 Cloudflare Pages 등에서 바로 배포 가능. -->
</body>
</html>
